# wcm_io_devops.conga_aem_dispatcher_flush

This role flushes AEM dispatcher caches of a
[CONGA](http://devops.wcm.io/conga/) `aem-dispatcher` role.

> This role was developed as part of the
> [wcm.io DevOps Ansible Automation for AEM](http://devops.wcm.io/ansible-aem/)
> to integrate Ansible with
> [CONGA](http://devops.wcm.io/conga/).

## Requirements

This role requires Ansible 2.7 or higher.

## Role Variables

Available variables are listed below, along with their default values:

        conga_aem_dispatcher_target_query: "*.*.flushTarget.url[]"

The jmespath query executed on the conga_config dict generated by
[wcm_io_devops.conga_facts](https://github.com/wcm-io-devops/ansible-conga-facts) to determine
the flush targets for the current CONGA role.

## Dependencies

This role depends on the
[wcm_io_devops.conga_facts](https://github.com/wcm-io-devops/ansible-conga-facts) role
for accessing the CONGA configuration model and
[wcm_io_devops.aem_dispatcher_flush](https://github.com/wcm-io-devops/ansible-aem-dispatcher-flush)
for executing the flush.

## Example Playbook

Flushes the dispatcher caches for the roles aem-author and aem-publish.

```yaml
# Setup & Execute CONGA
- hosts: localhost
  roles:
    - {
        role: wcm_io_devops.conga_maven,
        tags: conga,
        # only run when conga configuration was not generated before
        when: (conga_configuration_generated is undefined) or (conga_configuration_generated == "false")
      }

- hosts: "&{{ conga_environment }}:aem-author"
  vars:
    conga_node: aem-author
    conga_role_mapping: aem-cms
  roles:
    - wcm_io_devops.conga_aem_dispatcher_flush

- hosts: "&{{ conga_environment }}:aem-publish"
  vars:
    conga_node: aem-publish
    conga_role_mapping: aem-cms
  roles:
    - wcm_io_devops.conga_aem_dispatcher_flush
```

## License

Apache 2.0
